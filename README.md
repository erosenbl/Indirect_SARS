# Code for "Fomites could determine severity of SARS-CoV-2 outbreaks in low-density white-tailed deer (Odocoileus virginianus) populations"

## Information

Repository Type: Program R script

Year of Origin: 2024

Year of Version 2024

Version: 1.0.0

Digital Object Identifier (DOI): https://doi.org/10.5066/P19KKRVV

### Overview
This software release contains 1 RMarkdown file (Indirect_SARS_analysis.RMD) and necessary input data and functions that support the analysis presented in referenced manuscript. This RMarkdown file that steps through the estimation of parameters that allow:

1.  Compile estimated and derived parameters for both indirect and direct transmission pathways for SARS-CoV-2 in white-tailed deer and humans;
2.  Project outbreaks using SIRS ODEs modified from the whitetailedSIRS package (Rosenblatt et al. 2023), and estimate cumulative Force of Infection (FOI) considering both direct and indirect transmission pathways;
3.  Evaluate sensitivity of outbreaks to FOI and basic reproductive number (R0), and thus identify when increases in FOI from indirect transmission most alter outbreak dynamics of SARS-CoV-2 in deer;
4.  And describe the prevalence and distribution of deer population segments across the contiguous US that may be sensitive to the increased burden of indirect transmission pathways.

### Code
#### File: Indirect_SARS_Analysis.Rmd
**Data inputs:** Experted elicited responses (drawn from whitetailedSIRS package and virologyRRDistParameters.RDS), 100mX100m-pixel land cover data (Hab_100m.csv), proportions of wastewater effleunt in stream and river discharge across white-tailed deer range in the U.S. (RiverContaminationAcrossDeerRange.csv), and surface water body distribution data across white-tailed deer range in the U.S. (Waterbodies_clipped_to_deer.csv).

**Details:**  This RMarkdown file walks through the analysis used for the manuscript referenced above, analyzing the potential risk of indirect transmission influencing SARS-CoV-2 outbreaks and characterizing the widespread nature of this risk.

**Outputs:**  This file produces figures 2-4 used in referred manuscript, as well as a dataset to read into a GIS platform to map basic reproductive number across white-tailed deer range (Figure 5 in referenced manuscript; geo.100km2.df.withrisk.csv). Note that this dataset is not included with this software release, but can be generated by the user, if needed.

### Data Folder
#### File: Hab_100km2.csv

**Data inputs:** NA

**Details:** This dataset includes deer density class and landcover pixel summaries for 10kmX10km pixels across the white-tailed deer range in the US. Deer density classes come from Hanberry and Hanberry (2020), and land cover data (30x30m pixels) come from Dewitz (2023). Data fields include:

- id: pixel ID
- left: left boundary of pixel
- top: top boundary of pixel
- right: right boundary of pixel
- bottom: bottom boundary of pixel
- Class_name: Deer density class. Values include: green (<5.8 deer/km2), yellow (5.8 - 11.6 deer/km2), orange (11.6 - 15.4 deer/km2), and red (>17.37deer/km2).
- HISTO_0: Number of blank pixels
- HISTO_11: Number of open water pixels
- HISTO_12: Number of perennial Ice/Snow pixels
- HISTO_21: Number of Developed, Open Space pixels
- HISTO_22: Number of Developed, Low Intensity pixels
- HISTO_23: Number of Developed, Medium Intensity pixels
- HISTO_24: Number of Developed, High Intensity pixels
- HISTO_31: Number of Barren Land (Rock/Sand/Clay) pixels
- HISTO_41: Number of Deciduous Forest pixels
- HISTO_42: Number of Evergreen Forest pixels
- HISTO_43: Number of Mixed Forest pixels
- HISTO_52: Number of Scrub pixels
- HISTO_71: Number of Grassland/Herbaceous pixels
- HISTO_81: Number of Pasture/Hay pixels
- HISTO_82: Number of Cultivated Crops pixels
- HISTO_90: Number of Woody Wetlands pixels
- HISTO_95: Number of Emergent Herbaceous Wetlands pixels
- NAME: Which U.S. state the pixel is in.

**Outputs:** NA

#### File: RiverContaminationAcrossDeerRange.csv

**Data inputs:** NA

**Details:** A dataframe listing the proportion of stream and river discharge that come from wastewater discharge. Data originates from Ehalt Macedo et al. (2022). Fields include:

- PERCENT_WA: Proportion of discharge for a stream/river reach that originated from wasteater treatment plants
- STATEFP: State code identifier
- COUNTYFP: County code identifier

**Outputs:** NA

#### File: Waterbodies_clipped_to_deer.csv

**Data inputs:** NA

**Details:** A dataframe of waterbodies, their type, and area, attributed to the county level. These data came from the Lehner et al. (2008).

- OBJECTID: Waterbody ID
- NAME: Name of waterbody (if availabile)
- FTYPE: Waterbody type
- FCODE: Waterbody type (numeric code)
- FCODE_DESC: FCODE full description
- SQKM: Area of waterbody (km^2)
- SQMI: Area of waterbody (mi^2)
- STATEFP: State code identifier
- COUNTYFP: County code identifier

**Outputs:** NA

#### File: PFUWastePosRelationship.RDS

**Data inputs:** NA

**Details:** An object that holds the coefficient relating human positivity to raw sewage viral load, using a linear regression where SARS-CoV-2 plaque-forming unit concentration (per ml) is a function of human positivity, with a forced intercept of 0 (no human positivity, no SARS in raw sewage). This linear regression was fit to data from Zaneti et al. (2021).

**Outputs:** NA


### Functions Folder

#### File: alternative_indirect_and_direct.R

**Data inputs:** NA 

**Details:** R function that helps to prepare parameters used to solve SIRS ODE equations for both wild and captive deer facing direct and indirect transmission of SARS-CoV-2, to be fed into the params argument of the run_direct_and_indirect.R function. 21 parameters must be defined with lengths equal to the number of simulations run. This function takes these parameter inputs and calculates derived transmission rate parameters for use with the ODE equations.

**Outputs:** A list of vector objects containing estimates for derived parameters, for use with the run_direct_and_indirect.R function

#### File: direct_and_indirect_sirs.R

**Data inputs:** Outputs from alternative_indirect_and_direct.R

**Details:** R function that defines the ODE SIR equations to work alongside the `deSolve::ode()` function, and it will return an object with the proportion of individuals found in each of the SIR compartments at each of the specified time points. This function is used in this package to calculate persistence, or the steady state equilibrium (via `rootSolve::run_steady()`), along with how compartment sizes change through a projection. 

**Outputs:** NA

#### File: direct_and_indirect_sirs_with_cumulative.R

**Data inputs:** Outputs from alternative_indirect_and_direct.R

**Details:**  Similar to `direct_and_indirect_sirs`, this R function  defines the ODE SIR equations to work alongside the `deSolve::ode()` function, and it will return an object with the proportion of individuals found in each of the SIR compartments at each of the specified time points. An added feature is that this function has ODE equations to calculate the cumulative infections from day 0 to day t. 

**Outputs:** N/A

#### File: pinfectPFU.R

**Data inputs:** N/A

**Details:** A function to calculate probability of infection given a SARS-CoV-2 dose ingested, following the Wells-Riley formulation.

**Outputs:** An object containing probability of infection given the dose(s) received by an animal.

#### File: predWasteC.R

**Data inputs:** Coefficient relating human positivity to raw sewage SARS-CoV-2 viral load.

**Details:** This function will predict the raw sewage SARS-CoV-2 viral load given human prevalence, using regression coefficients fit to data from Zaneti et al. (2021), stored in PFUWastePosRelationship.

**Outputs:** An object containing raw sewage SARS-CoV-2 viral load.

#### File: run_direct_and_indirect.R

**Data inputs:** NA

**Details:** R function that Run ODE Solver for SIRS model, using parameter estimates (output from alternative_indirect_and_direct.R), initial compartment sizes for projection (output from initial_compartments.R with argument steady = FALSE) and initial compartment sizes formatted for steady state calculation (output from initial_compartments.R with argument steady = TRUE).

**Outputs:** A list containing a run identifier (run_id), initial compartment sizes for projection (inits.fall), initial compartment sizes for steady state calculation (inits.steady), parameter values used for each run (params), compartment sizes for each time step in reach run (ode_proj), compartment sizes at steady-state equilibrium (steady_state), and the scenario label for each run_id (Context). This output is used for all visualization and table summaries.

## References
- Dewitz, J., 2023, National Land Cover Database (NLCD) 2021 Products: U.S. Geological Survey data release, https://doi.org/10.5066/P9JZ7AO3.
- Ehalt Macedo, H., Lehner, B., Nicell, J., Grill, G., Li, J., Limtong, A. and Shakya, R., 2022. Distribution and characteristics of wastewater treatment plants within the global river network. Earth System Science Data, 14(2), pp.559-577.
- Hanberry, B. and Hanberry, P., 2020. Rapid digitization to reclaim thematic maps of white-tailed deer density from 1982 and 2003 in the conterminous US. PeerJ, 8, p.e8262.
- Lehner, B., Verdin, K., Jarvis, A. (2008): New global hydrography derived from spaceborne elevation data. Eos, Transactions, 89(10): 93-94. Data available at https://www.hydrosheds.org.
- Rosenblatt, E, Rudolph, J.F., and Arce, F., Cook, J. D., DiRenzo, G.V., Grant, E.H.C., Runge, M.C., and Mosher, B.A.. 2023. whitetailedSIRS: A package to project SARS-CoV-2 outbreak dynamics in white-tailed deer. Version 1.0.0: U.S. Geological Survey software release, https://doi.org/10.5066/P9TZK938
- Zaneti, R.N., Girardi, V., Spilki, F.R., Mena, K., Westphalen, A.P.C., da Costa Colares, E.R., Pozzebon, A.G. and Etchepare, R.G., 2021. Quantitative microbial risk assessment of SARS-CoV-2 for workers in wastewater treatment plants. Science of the Total Environment, 754, p.142163.
